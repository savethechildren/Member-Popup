import*as util from"./utilities2.js";import*as geo from"./members.js";import*as analytics from"./analytics.js";window.stc=window.stc||{},window.stc.util={...util,...window.stc.util},window.stc.geo={...geo,...window.stc.geo},window.stc.analytics=analytics;let element=null;const close=e=>{window.stc.modal.hide(),window.stc.util.setCookie("stc_popup_closed","1",14,window.stc.util.getDomain(window.location.hostname));const t="string"==typeof e?e:"Close";window.stc.analytics&&window.stc.analytics.isOn()&&window.stc.analytics.sendEvent("Member popup",t,`${window.stc.geo.country} - ${t}`)},init=()=>{const e=util.newDOMElement("div","stc-popup-modal","stcPopupModal");e.style.opacity=0,e.addEventListener("click",e=>e.currentTarget===e.target&&(window.stc.modal.close(),!0),!1);const t=util.newDOMElement("div","stc-popup-modal-inner","stcPopupInnerModal"),n=util.newDOMElement("div","stc-popup-modal-close",null,{title:"Close"}),o=util.newDOMElement("div","stc-popup-modal-gradient-box");t.appendChild(o),n.addEventListener("click",close,!1),t.appendChild(n);const i=util.newDOMElement("div","stc-popup-modal-content");window.addEventListener("keyup",e=>{27===e.keyCode&&window.stc.modal.close()},!1);const s=util.newDOMElement("picture",""),l=util.newDOMElement("img","img-fluid",null,{alt:"Children playing with water",src:`${window.stc.modal.baseURL}/img/children_dsk.jpg`}),c=util.newDOMElement("source",null,null,{media:"(max-width: 640px) and (orientation: portrait)",srcset:`${window.stc.modal.baseURL}/img/children_mob.jpg`}),a=util.newDOMElement("source",null,null,{media:"(min-width: 641px)",srcset:`${window.stc.modal.baseURL}/img/children_dsk.jpg`});s.appendChild(c),s.appendChild(a),s.appendChild(l),t.appendChild(s),t.appendChild(i),e.appendChild(t),document.getElementsByTagName("body")[0].appendChild(e),element=e;const d=geo.extendedMembers[stc.geo.country];import("./i18n/"+stc.popupOrigin+".js").then(e=>{stc.i18n=e.i18n;var t=e.i18n[stc.geo.userLanguage.substr(0,2)]?e.i18n[stc.geo.userLanguage.substr(0,2)]:e.i18n.default,n=t.countries[stc.geo.country],o=t.text.replace(/\{country\}/g,n).replace(/\{prefixCountry\}/g,geo.prefix(n)).replace(/\.\./g,"."),s=t.goBtn;i.innerHTML="<h1>"+t.title+'</h1><div class="stc-popup-modal-content-body" id="stc-popup-content"><p>'+o+'</p><p><a href="javascript:window.stc.modal.close(\'Stay\')" class="btn btn-empty btn-lg" id="stc-popup-stay">'+t.stayBtn+'</a><a href="'+d.url+'" class="btn btn-primary btn-lg" id="stc-popup-continue">'+s.replace("{country}",geo.prefix(n))+"</a></p>",document.getElementById("stc-popup-continue").addEventListener("click",stc.modal.trackOutbound)})},show=()=>{element.style.removeProperty("opacity"),element.className+=" on",document.getElementsByTagName("body")[0].style.overflow="hidden"},hide=()=>{element.className=element.className.replace(" on",""),document.getElementsByTagName("body")[0].style.overflow="auto"},trackOutbound=e=>{e.preventDefault(),window.stc.analytics&&stc.analytics.isOn()?(window.stc.analytics.sendEvent("Member popup","Go",`${geo.country} - Go`,()=>{window.location=e.target}),window.setTimeout(()=>{window.location=e.target},1e3)):window.location=e.target};export{element,close,hide,init,show,trackOutbound};